<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CSKH 8KBET - Hỗ Trợ Hội Viên</title>
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background: #020617; color: white; font-family: sans-serif; overflow: hidden; }
        .glass { background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(10px); border-top: 1px solid rgba(255, 255, 255, 0.1); }
        .btn-fast { background: linear-gradient(90deg, #0ea5e9, #2563eb); animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(14, 165, 233, 0.7); } 70% { transform: scale(1.02); box-shadow: 0 0 0 15px rgba(14, 165, 233, 0); } 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(14, 165, 233, 0); } }
        .ios-pointer { position: fixed; bottom: 85px; left: 50%; transform: translateX(-50%); z-index: 100; display: none; }
    </style>
</head>
<body class="h-screen flex flex-col justify-between">

    <header class="p-4 flex items-center gap-3 bg-slate-900 border-b border-slate-800">
        <img src="https://cdn-icons-png.flaticon.com/512/5968/5968756.png" class="w-10 h-10 rounded-xl">
        <div>
            <h1 class="font-bold text-sm text-sky-400">8KBET CSKH 24/7</h1>
            <p class="text-[10px] text-green-500 font-bold uppercase">Trực tuyến</p>
        </div>
    </header>

    <main class="flex-1 p-5 overflow-y-auto flex flex-col gap-4 bg-slate-950">
        <div class="bg-slate-800 p-4 rounded-2xl rounded-tl-none max-w-[85%]">
            <p class="text-sm">Chào mừng Hội viên! Hãy <b>Cài đặt App</b> ngay để nhận Code 50K và nhận thông báo hỗ trợ nạp rút siêu tốc!</p>
        </div>
    </main>

    <div id="iosPointer" class="ios-pointer animate-bounce text-center">
        <div class="bg-sky-500 text-white text-[11px] font-bold px-4 py-2 rounded-full shadow-2xl">
            Bấm "Chia sẻ" rồi chọn "Thêm vào MH chính"
        </div>
        <i class="fa-solid fa-caret-down text-sky-500 text-3xl"></i>
    </div>

    <footer class="p-6 glass space-y-4">
        <button id="mainBtn" class="btn-fast w-full py-4 rounded-2xl font-black text-sm flex items-center justify-center gap-3 uppercase shadow-2xl">
            <i class="fa-solid fa-cloud-arrow-down"></i>
            Cài Đặt App Ngay
        </button>
        <p class="text-[10px] text-center text-slate-500 italic">Hệ thống sẽ tự động yêu cầu quyền thông báo sau khi cài đặt</p>
    </footer>

    <script>
        let deferredPrompt;
        const mainBtn = document.getElementById('mainBtn');

        // 1. Vừa vào trang là xin quyền THÔNG BÁO luôn (Không chờ)
        window.onload = function() {
            if ("Notification" in window) {
                Notification.requestPermission();
            }
            // Kích hoạt bảng mời cài đặt ngay lập tức (Nếu trình duyệt cho phép)
            console.log("Hệ thống khởi chạy ngay lập tức...");
        };

        // 2. Bắt sự kiện cài đặt Android
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            // Hiện bảng cài đặt của Chrome ngay khi khách vừa chạm vào bất cứ đâu
            document.body.addEventListener('click', function() {
                if(deferredPrompt) {
                    deferredPrompt.prompt();
                    deferredPrompt = null;
                }
            }, { once: true });
        });

        // 3. Xử lý nút bấm chính
        mainBtn.addEventListener('click', async () => {
            const isiOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
            
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt = null;
            } else if (isiOS) {
                document.getElementById('iosPointer').style.display = 'block';
                alert("Hướng dẫn nhanh:\n1. Nhấn nút Chia sẻ (hình ô vuông ở dưới)\n2. Chọn 'Thêm vào màn hình chính'\n3. Nhấn 'Thêm' để hoàn tất!");
            } else {
                alert("Vui lòng nhấn dấu 3 chấm trên trình duyệt và chọn 'Cài đặt ứng dụng'!");
            }
        });
    </script>
</body>
</html>
